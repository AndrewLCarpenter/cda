import arctic
from arctic import Arctic
import pytz
from pprint import pprint
from datetime import datetime as dt

est = pytz.timezone('US/Eastern')

# Connect to mongo
def initialize_db():
    db = Arctic('localhost')
    # db.delete_library('binance.orderbook')
    libs = db.list_libraries()
    if 'binance.orderbook' not in libs:
        print('No binance orderbook tickstore -- creating one')
        db.initialize_library('binance.orderbook',lib_type=arctic.TICK_STORE)
    return db


to_convert = {'bids': {
      "0.00021248": "2332.00000000",
      "0.00021175": "234.00000000",
      "0.00021120": "160.00000000",
      "0.00021101": "700.00000000",
      "0.00021100": "8764.00000000",
      "0.00021090": "39.00000000",
      "0.00021015": "87.00000000",
      "0.00021013": "593.00000000",
      "0.00021011": "267.00000000",
      "0.00021010": "100.00000000",
      "0.00021002": "2380.00000000",
      "0.00021001": "1400.00000000",
      "0.00021000": "1223.00000000",
      "0.00020932": "72.00000000",
      "0.00020888": "11020.00000000",
      "0.00020880": "291.00000000",
      "0.00020812": "500.00000000",
      "0.00020811": "100.00000000",
      "0.00020800": "1157.00000000",
      "0.00020700": "1955.00000000",
      "0.00020698": "35.00000000",
      "0.00020647": "410.00000000",
      "0.00020602": "125.00000000",
      "0.00020560": "9.00000000",
      "0.00020536": "26.00000000",
      "0.00020530": "66.00000000",
      "0.00020510": "100.00000000",
      "0.00020500": "606.00000000",
      "0.00020499": "99.00000000",
      "0.00020491": "34.00000000",
      "0.00020400": "456.00000000",
      "0.00020394": "243.00000000",
      "0.00020389": "40.00000000",
      "0.00020388": "500.00000000",
      "0.00020361": "5.00000000",
      "0.00020300": "150.00000000",
      "0.00020268": "636.00000000",
      "0.00020267": "2147.00000000",
      "0.00020200": "400.00000000",
      "0.00020198": "16.00000000",
      "0.00020152": "21.00000000",
      "0.00020113": "20.00000000",
      "0.00020100": "150.00000000",
      "0.00020070": "50.00000000",
      "0.00020059": "5.00000000",
      "0.00020056": "1383.00000000",
      "0.00020015": "5091.00000000",
      "0.00020010": "450.00000000",
      "0.00020005": "5115.00000000",
      "0.00020002": "1000.00000000",
      "0.00020000": "34826.00000000",
      "0.00019950": "41.00000000",
      "0.00019888": "6000.00000000",
      "0.00019880": "2380.00000000",
      "0.00019860": "5868.00000000",
      "0.00019818": "2500.00000000",
      "0.00019809": "301.00000000",
      "0.00019800": "423.00000000",
      "0.00019735": "200.00000000",
      "0.00019728": "22.00000000",
      "0.00019608": "200.00000000",
      "0.00019500": "973.00000000",
      "0.00019497": "1111.00000000",
      "0.00019452": "56.00000000",
      "0.00019406": "105.00000000",
      "0.00019399": "2604.00000000",
      "0.00019388": "328.00000000",
      "0.00019320": "634.00000000",
      "0.00019300": "6.00000000",
      "0.00019200": "1867.00000000",
      "0.00019117": "5262.00000000",
      "0.00019101": "614.00000000",
      "0.00019100": "30.00000000",
      "0.00019080": "61.00000000",
      "0.00019075": "164.00000000",
      "0.00019050": "8.00000000",
      "0.00019001": "93.00000000",
      "0.00019000": "5269.00000000",
      "0.00018888": "7035.00000000",
      "0.00018880": "15.00000000",
      "0.00018800": "219.00000000",
      "0.00018700": "20328.00000000",
      "0.00018669": "8.00000000",
      "0.00018600": "1112.00000000",
      "0.00018538": "1383.00000000",
      "0.00018500": "5308.00000000",
      "0.00018253": "30.00000000",
      "0.00018195": "63.00000000",
      "0.00018100": "225.00000000",
      "0.00018011": "500.00000000",
      "0.00018000": "2697.00000000",
      "0.00017800": "250.00000000",
      "0.00017600": "30.00000000",
      "0.00017500": "1724.00000000",
      "0.00017483": "65.00000000",
      "0.00017400": "1339.00000000",
      "0.00017200": "133.00000000",
      "0.00017170": "7.00000000",
      "0.00017100": "300.00000000",
      "0.00017000": "2006.00000000",
      "0.00020889": "700.00000000"
    },
              'asks': {'0.00022296': '990.00000000',
                       '0.00022300': '172.00000000',
                       '0.00022401': '126.00000000',
                       '0.00022500': '100.00000000',
                       '0.00022571': '844.00000000',
                       '0.00022578': '126.00000000',
                       '0.00022670': '5.00000000',
                       '0.00022680': '7.00000000',
                       '0.00022685': '194.00000000',
                       '0.00022728': '87.00000000'
                       },
              'id': 12206256,
              'timestamp': 1508962755251
              }

to_convert['bids']['0.00021249'] = '34'

pprint(to_convert)